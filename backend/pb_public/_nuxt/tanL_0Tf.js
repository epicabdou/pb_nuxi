import{u as R,r,g as q,j as I,h as K,c as a,a as t,k as m,d as u,n as $,v as D,t as d,F as O,l as X,m as Z,I as H,p as ee,J as te,o as i}from"./DzVV_QxS.js";const se={class:"responsive-container section-padding"},oe={class:"flex justify-between items-center mb-8"},le={class:"card-flat mb-6 p-4"},re={class:"flex flex-col md:flex-row gap-4"},ne={class:"flex-grow"},ae={class:"flex justify-end items-center gap-2"},ie={class:"text-sm text-background-600 dark:text-background-400"},de={key:0,class:"flex justify-center items-center py-12"},ue={key:1,class:"card-flat flex flex-col items-center py-16"},ce={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},me={class:"flex items-center mb-3"},ge={class:"heading-5 truncate flex-grow"},ve={class:"dropdown relative ml-2"},pe={class:"dropdown-menu hidden absolute right-0 mt-2 w-48 bg-white dark:bg-background-800 rounded-lg shadow-lg z-10 border border-background-300 dark:border-background-700"},we={class:"py-1"},ke=["onClick"],be=["onClick"],he={class:"text-sm text-background-600 dark:text-background-400 mb-3"},fe={class:"inline-flex items-center"},xe={class:"flex justify-between items-center pt-3 border-t border-background-300 dark:border-background-700"},ye={class:"flex items-center"},Ce={class:"text-sm text-background-600 dark:text-background-400"},Me={class:"text-sm text-background-500"},Te={key:3,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},_e={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Le={class:"inline-block align-bottom bg-white dark:bg-background-800 rounded-xl text-left overflow-hidden shadow-modern transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},je={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Be={class:"heading-3 mb-6"},ze={class:"grid grid-cols-1 gap-6"},Ee={class:"font-medium"},Ae={class:"flex justify-between"},Se=["disabled"],$e={key:0,class:"text-xs text-background-500 mt-1"},De={class:"px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-background-300 dark:border-background-700"},He=["disabled"],Fe={key:0,class:"inline-block animate-spin mr-2"},Ve={key:4,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Ne={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Pe={class:"inline-block align-bottom bg-white dark:bg-background-800 rounded-xl text-left overflow-hidden shadow-modern transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},qe={class:"bg-white dark:bg-background-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ie={class:"sm:flex sm:items-start"},Ue={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},Ge={class:"mt-2"},We={key:0,class:"text-error-500 mb-4 p-3 bg-error-100 dark:bg-error-900 rounded-lg"},Ye={class:"body-regular text-background-600 dark:text-background-400"},Je={class:"bg-background-100 dark:bg-background-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Qe=["disabled"],Re={key:0,class:"inline-block animate-spin mr-2"},Ke={key:0,class:"h-6 w-6 mr-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Oe={key:1,class:"h-6 w-6 mr-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Xe={key:2,class:"h-6 w-6 mr-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},tt={__name:"tags",setup(Ze){const{$pb:k}=R(),y=r(!0),C=r(!1),M=r(!1),b=r([]),T=r(""),h=r(!1),f=r(!1),p=r(!1),g=r(!0),c=r(null),z=r(!1),_=r(0),L=r(!1),F=r(""),w=r("info"),E=r(null),l=r({name:"",slug:""}),V=()=>{te(()=>{document.querySelectorAll(".dropdown button").forEach(e=>{const n=e.nextElementSibling;e.addEventListener("click",o=>{o.stopPropagation(),n.classList.toggle("hidden")}),document.addEventListener("click",()=>{n.classList.add("hidden")})})})},j=q(()=>{if(!T.value)return b.value;const s=T.value.toLowerCase();return b.value.filter(e=>e.name.toLowerCase().includes(s)||e.slug.toLowerCase().includes(s))}),U=q(()=>A(l.value.name||"New Tag").replace(")",", 0.1)").replace("rgb","rgba"));I(()=>l.value.name,s=>{g.value&&s&&(l.value.slug=N(s))}),I(j,()=>{V()},{deep:!0});const B=async()=>{y.value=!0;try{const s=await k.collection("tags").getFullList({sort:"name"}),e=await Promise.all(s.map(async n=>{try{const o=await k.collection("products").getList(1,1,{filter:`tags ~ "${n.id}"`});return{...n,productCount:o.totalItems}}catch(o){return console.error(`Error fetching products for tag ${n.id}:`,o),{...n,productCount:0}}}));b.value=e,V()}catch(s){console.error("Error fetching tags:",s),b.value=[],v("Failed to load tags","error")}finally{y.value=!1}},N=s=>s.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),G=()=>{g.value=!g.value,g.value&&l.value.name&&(l.value.slug=N(l.value.name))},W=s=>{if(!s)return"";const e=new Date(s),n={year:"numeric",month:"short",day:"numeric"};return e.toLocaleDateString(void 0,n)},A=s=>{if(!s)return"rgb(156, 163, 175)";let e=0;for(let o=0;o<s.length;o++)e=s.charCodeAt(o)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 65%, 55%)`},S=(s=null)=>{s?(p.value=!0,l.value={...s},g.value=!1):(p.value=!1,l.value={name:"",slug:""},g.value=!0),h.value=!0},P=()=>{p.value&&(l.value.name!==(c==null?void 0:c.name)||l.value.slug!==(c==null?void 0:c.slug))||!p.value&&(l.value.name||l.value.slug)?confirm("Discard unsaved changes?")&&(h.value=!1):h.value=!1},Y=async()=>{var s,e,n,o;C.value=!0;try{p.value?(await k.collection("tags").update(l.value.id,l.value),v("Tag updated successfully","success")):(await k.collection("tags").create(l.value),v("Tag created successfully","success")),B(),h.value=!1}catch(x){console.error("Error saving tag:",x),((o=(n=(e=(s=x.response)==null?void 0:s.data)==null?void 0:e.data)==null?void 0:n.slug)==null?void 0:o.code)==="validation_not_unique"?v("A tag with this slug already exists","error"):v(x.message||"Failed to save tag. Please try again.","error")}finally{C.value=!1}},J=async s=>{c.value=s;try{const e=await k.collection("products").getList(1,1,{filter:`tags ~ "${s.id}"`});z.value=e.totalItems>0,_.value=e.totalItems}catch(e){console.error("Error checking related products:",e),z.value=!1,_.value=0}f.value=!0},Q=async()=>{M.value=!0;try{await k.collection("tags").delete(c.value.id),v("Tag deleted successfully","success"),B(),f.value=!1,c.value=null}catch(s){console.error("Error deleting tag:",s),v(s.message||"Failed to delete tag. Please try again.","error")}finally{M.value=!1}},v=(s,e="info")=>{E.value&&clearTimeout(E.value),F.value=s,w.value=e,L.value=!0,E.value=setTimeout(()=>{L.value=!1},5e3)};return K(async()=>{try{await B()}catch(s){console.error("Error initializing component:",s),v("Failed to load data","error")}finally{y.value=!1}}),(s,e)=>{var n;return i(),a("div",se,[t("div",oe,[e[9]||(e[9]=t("h1",{class:"heading-2"},"Tags Management",-1)),t("button",{onClick:e[0]||(e[0]=o=>S()),class:"btn-primary"},e[8]||(e[8]=[t("span",{class:"flex items-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),u(" Add New Tag ")],-1)]))]),t("div",le,[t("div",re,[t("div",ne,[$(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>T.value=o),type:"text",placeholder:"Search tags...",class:"input-primary w-full"},null,512),[[D,T.value]])]),t("div",ae,[t("span",ie,d(j.value.length)+" tag"+d(j.value.length!==1?"s":""),1),t("button",{onClick:B,class:"btn-ghost px-2"},e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))])])]),y.value?(i(),a("div",de,e[11]||(e[11]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):!b.value||b.value.length===0?(i(),a("div",ue,[e[13]||(e[13]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-background-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),e[14]||(e[14]=t("h3",{class:"heading-4 mb-2"},"No Tags Found",-1)),e[15]||(e[15]=t("p",{class:"body-regular text-background-600 dark:text-background-400 mb-6"}," Tags help organize your products and improve search functionality. ",-1)),t("button",{onClick:e[2]||(e[2]=o=>S()),class:"btn-primary"},e[12]||(e[12]=[t("span",{class:"flex items-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),u(" Create Your First Tag ")],-1)]))])):(i(),a("div",ce,[(i(!0),a(O,null,X(j.value,o=>(i(),a("div",{key:o.id,class:"card-flat hover:shadow-md transition-shadow duration-200"},[t("div",me,[t("div",{class:"w-4 h-4 rounded-full mr-3",style:H({backgroundColor:A(o.name)})},null,4),t("h3",ge,d(o.name),1),t("div",ve,[e[18]||(e[18]=t("button",{class:"btn-ghost px-2 py-1"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})])],-1)),t("div",pe,[t("ul",we,[t("li",null,[t("button",{onClick:x=>S(o),class:"flex items-center w-full px-4 py-2 text-sm text-left text-background-700 dark:text-background-300 hover:bg-background-100 dark:hover:bg-background-700"},e[16]||(e[16]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),u(" Edit ")]),8,ke)]),t("li",null,[t("button",{onClick:x=>J(o),class:"flex items-center w-full px-4 py-2 text-sm text-left text-error-600 hover:bg-background-100 dark:hover:bg-background-700"},e[17]||(e[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),u(" Delete ")]),8,be)])])])])]),t("p",he,[t("span",fe,[e[19]||(e[19]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),u(" "+d(o.slug),1)])]),t("div",xe,[t("div",ye,[e[20]||(e[20]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1 text-background-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})],-1)),t("span",Ce,d(o.productCount||0)+" product"+d(o.productCount!==1?"s":""),1)]),t("div",Me,d(W(o.created)),1)])]))),128))])),h.value?(i(),a("div",Te,[t("div",_e,[t("div",{class:"fixed inset-0 bg-background-900 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:P}),e[24]||(e[24]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),t("div",Le,[t("form",{onSubmit:Z(Y,["prevent"])},[t("div",je,[t("h3",Be,d(p.value?"Edit Tag":"Create New Tag"),1),t("div",ze,[t("div",{class:"p-4 rounded-lg border border-background-300 dark:border-background-700 flex items-center",style:H({backgroundColor:U.value})},[t("div",{class:"w-4 h-4 rounded-full mr-3",style:H({backgroundColor:A(l.value.name||"New Tag")})},null,4),t("span",Ee,d(l.value.name||"Tag Preview"),1)],4),t("div",null,[e[21]||(e[21]=t("label",{for:"name",class:"input-label"},"Tag Name",-1)),$(t("input",{id:"name","onUpdate:modelValue":e[3]||(e[3]=o=>l.value.name=o),type:"text",class:"input-primary",placeholder:"e.g. Summer Sale, Featured, Limited Edition",required:"",autofocus:""},null,512),[[D,l.value.name]])]),t("div",null,[t("div",Ae,[e[22]||(e[22]=t("label",{for:"slug",class:"input-label"},"Slug",-1)),t("button",{type:"button",onClick:G,class:"text-xs text-primary-500 hover:text-primary-600"},d(g.value?"Edit manually":"Auto-generate"),1)]),$(t("input",{id:"slug","onUpdate:modelValue":e[4]||(e[4]=o=>l.value.slug=o),type:"text",class:"input-primary",disabled:g.value,placeholder:"e.g. summer-sale",required:""},null,8,Se),[[D,l.value.slug]]),g.value?(i(),a("p",$e," Automatically generated from the tag name ")):m("",!0)])])]),t("div",De,[t("button",{type:"submit",class:"btn-primary sm:ml-3",disabled:C.value},[C.value?(i(),a("span",Fe,e[23]||(e[23]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))):m("",!0),u(" "+d(p.value?"Update Tag":"Create Tag"),1)],8,He),t("button",{type:"button",onClick:P,class:"btn-secondary mt-3 sm:mt-0"}," Cancel ")])],32)])])])):m("",!0),f.value?(i(),a("div",Ve,[t("div",Ne,[t("div",{class:"fixed inset-0 bg-background-900 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:e[5]||(e[5]=o=>f.value=!1)}),e[35]||(e[35]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),t("div",Pe,[t("div",qe,[t("div",Ie,[e[32]||(e[32]=t("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-error-100 dark:bg-error-900 sm:mx-0 sm:h-10 sm:w-10"},[t("svg",{class:"h-6 w-6 text-error-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t("div",Ue,[e[31]||(e[31]=t("h3",{class:"heading-4",id:"modal-title"},"Delete Tag",-1)),t("div",Ge,[z.value?(i(),a("p",We,[e[25]||(e[25]=t("strong",null,"Warning:",-1)),u(" This tag is used by "+d(_.value)+" product"+d(_.value!==1?"s":"")+". Deleting it will remove the tag from these products. ",1)])):m("",!0),t("p",Ye,[e[26]||(e[26]=u(' Are you sure you want to delete the tag "')),t("strong",null,d((n=c.value)==null?void 0:n.name),1),e[27]||(e[27]=u('"? ')),e[28]||(e[28]=t("br",null,null,-1)),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=u(" This action cannot be undone. "))])])])])]),t("div",Je,[t("button",{onClick:Q,type:"button",class:"btn-primary bg-error-600 hover:bg-error-700 focus:ring-error-500 sm:ml-3",disabled:M.value},[M.value?(i(),a("span",Re,e[33]||(e[33]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))):m("",!0),e[34]||(e[34]=u(" Yes, Delete Tag "))],8,Qe),t("button",{onClick:e[6]||(e[6]=o=>f.value=!1),type:"button",class:"btn-secondary mt-3 sm:mt-0"}," Cancel ")])])])])):m("",!0),L.value?(i(),a("div",{key:5,class:ee(["fixed bottom-6 right-6 max-w-md p-4 rounded-xl shadow-elevated transition-all flex items-center",{"bg-success-500 text-white":w.value==="success","bg-error-500 text-white":w.value==="error","bg-primary-500 text-white":w.value==="info"}])},[w.value==="success"?(i(),a("svg",Ke,e[36]||(e[36]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):m("",!0),w.value==="error"?(i(),a("svg",Oe,e[37]||(e[37]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):m("",!0),w.value==="info"?(i(),a("svg",Xe,e[38]||(e[38]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):m("",!0),t("div",null,d(F.value),1),t("button",{onClick:e[7]||(e[7]=o=>L.value=!1),class:"ml-auto pl-3 text-white hover:text-background-100"},e[39]||(e[39]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))],2)):m("",!0)])}}};export{tt as default};
