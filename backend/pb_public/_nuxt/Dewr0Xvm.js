import{u as Q,r as n,g as X,j as Y,h as Z,c as r,a as t,k as i,d as M,F as U,l as V,m as T,t as v,n as j,v as A,C as ee,p as te,A as se,o as a}from"./DzVV_QxS.js";const oe={class:"responsive-container section-padding"},le={class:"flex justify-between items-center mb-8"},re={key:0,class:"flex justify-center items-center py-12"},ae={key:1,class:"card-flat flex flex-col items-center py-12"},ne={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ie={class:"flex flex-col h-full"},de={class:"mb-4 relative aspect-video overflow-hidden rounded-lg"},ue=["src"],ce={class:"flex-grow"},ve={class:"heading-4 mb-2"},me={key:0,class:"text-background-600 dark:text-background-400 mb-3"},ge={class:"text-sm text-background-500 mb-4"},pe={class:"inline-flex items-center"},be={class:"flex justify-end space-x-2 pt-3 border-t border-background-300 dark:border-background-700 mt-auto"},fe=["onClick"],ke=["onClick"],we={key:3,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},he={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ye={class:"inline-block align-bottom bg-white dark:bg-background-800 rounded-xl text-left overflow-hidden shadow-modern transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},xe={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ce={class:"heading-3 mb-6"},_e={class:"grid grid-cols-1 gap-6"},Me={class:"flex space-x-2"},je=["disabled"],De={xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Be={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},$e={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"},Le={key:0,class:"text-xs text-background-500 mt-1"},Te=["value","disabled"],Ae={key:0,class:"mb-4 flex justify-center"},ze=["src"],Fe={class:"px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-background-300 dark:border-background-700"},He=["disabled"],Ie={key:0,class:"inline-block animate-spin mr-2"},Ue={key:4,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Ve={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ne={class:"inline-block align-bottom bg-white dark:bg-background-800 rounded-xl text-left overflow-hidden shadow-modern transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Ee={class:"bg-white dark:bg-background-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Se={class:"sm:flex sm:items-start"},Pe={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},Re={class:"mt-2"},qe={key:0,class:"text-error-500 mb-2"},Ge={class:"body-regular text-background-600 dark:text-background-400"},Oe={class:"bg-background-100 dark:bg-background-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},We=["disabled"],Je={key:0,class:"inline-block animate-spin mr-2"},Ke={class:"flex items-center"},Qe={key:0,class:"h-6 w-6 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Xe={key:1,class:"h-6 w-6 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ye={key:2,class:"h-6 w-6 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},tt={__name:"categories",setup(Ze){const{$pb:f}=Q(),N=se(),y=n(!0),x=n(!1),C=n(!1),m=n([]),k=n(!1),w=n(!1),p=n(!1),d=n(!0),h=n(null),b=n(""),_=n(null),D=n(!1),B=n(!1),z=n(""),g=n("info"),$=n(null),E=n(null),l=n({name:"",slug:"",description:"",parent:"",image:null}),S=X(()=>p.value&&l.value.id?m.value.filter(s=>s.id!==l.value.id):m.value);Y(()=>l.value.name,s=>{d.value&&s&&(l.value.slug=F(s))});const L=async()=>{y.value=!0;try{const s=await f.collection("categories").getFullList({sort:"name",expand:"parent"});m.value=s}catch(s){console.error("Error fetching categories:",s),m.value=[]}finally{y.value=!1}},P=(s,e)=>s?s.length<=e?s:s.substring(0,e)+"...":"",F=s=>s.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),R=()=>{d.value=!d.value,d.value&&l.value.name&&(l.value.slug=F(l.value.name))},H=s=>!s||!s.image?"https://via.placeholder.com/400x225?text=No+Image":`${N.public.pocketbaseUrl}/api/files/categories/${s.id}/${s.image}`,I=(s=null)=>{d.value=!0,h.value=null,b.value="",s?(p.value=!0,l.value={...s},d.value=!1,s.image&&(b.value=H(s))):(p.value=!1,l.value={name:"",slug:"",description:"",parent:"",image:null}),k.value=!0},q=s=>{const e=s.target.files[0];if(!e)return;if(!e.type.includes("image/")){u("Please select an image file","error");return}h.value=e;const c=new FileReader;c.onload=o=>{b.value=o.target.result},c.readAsDataURL(e)},G=s=>{const e=s.dataTransfer.files[0];if(!e)return;if(!e.type.includes("image/")){u("Please drop an image file","error");return}h.value=e;const c=new FileReader;c.onload=o=>{b.value=o.target.result},c.readAsDataURL(e)},O=async()=>{x.value=!0;try{const s=new FormData;s.append("name",l.value.name),s.append("slug",l.value.slug),l.value.description&&s.append("description",l.value.description),l.value.parent&&s.append("parent",l.value.parent),h.value&&s.append("image",h.value),p.value?(await f.collection("categories").update(l.value.id,s),u("Category updated successfully","success")):(await f.collection("categories").create(s),u("Category created successfully","success")),L(),k.value=!1}catch(s){console.error("Error saving category:",s),u(s.message||"Failed to save category. Please try again.","error")}finally{x.value=!1}},W=async s=>{_.value=s;try{const e=await f.collection("products").getList(1,1,{filter:`category="${s.id}"`});D.value=e.totalItems>0}catch(e){console.error("Error checking related products:",e),D.value=!1}w.value=!0},J=async()=>{C.value=!0;try{await f.collection("categories").delete(_.value.id),u("Category deleted successfully","success"),L(),w.value=!1,_.value=null}catch(s){console.error("Error deleting category:",s),u(s.message||"Failed to delete category. Please try again.","error")}finally{C.value=!1}},u=(s,e="info")=>{$.value&&clearTimeout($.value),z.value=s,g.value=e,B.value=!0,$.value=setTimeout(()=>{B.value=!1},3e3)};return Z(async()=>{try{await L()}catch(s){console.error("Error initializing component:",s),u("Failed to load data","error")}finally{y.value=!1}}),(s,e)=>{var c;return a(),r("div",oe,[t("div",le,[e[12]||(e[12]=t("h1",{class:"heading-2"},"Categories Management",-1)),t("button",{onClick:e[0]||(e[0]=o=>I()),class:"btn-primary btn-icon-text"},e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add New Category ")]))]),y.value?(a(),r("div",re,e[13]||(e[13]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):!m.value||m.value.length===0?(a(),r("div",ae,e[14]||(e[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-background-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("h3",{class:"heading-4 mb-2"},"No Categories Found",-1),t("p",{class:"body-regular text-background-600 dark:text-background-400"}," Add your first category by clicking the button above. ",-1)]))):(a(),r("div",ne,[(a(!0),r(U,null,V(m.value,o=>(a(),r("div",{key:o.id,class:"card-flat hover:shadow-md transition-shadow duration-200"},[t("div",ie,[t("div",de,[t("img",{src:H(o),class:"w-full h-full object-cover",alt:"Category image"},null,8,ue)]),t("div",ce,[t("h3",ve,v(o.name),1),o.description?(a(),r("p",me,v(P(o.description,100)),1)):i("",!0),t("div",ge,[t("span",pe,[e[15]||(e[15]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})],-1)),M(" "+v(o.slug),1)])])]),t("div",be,[t("button",{onClick:K=>I(o),class:"btn-ghost text-secondary-600"},e[16]||(e[16]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,fe),t("button",{onClick:K=>W(o),class:"btn-ghost text-error-600"},e[17]||(e[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ke)])])]))),128))])),k.value?(a(),r("div",we,[t("div",he,[t("div",{class:"fixed inset-0 bg-background-900 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:e[1]||(e[1]=o=>k.value=!1)}),e[26]||(e[26]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),t("div",ye,[t("form",{onSubmit:T(O,["prevent"])},[t("div",xe,[t("h3",Ce,v(p.value?"Edit Category":"Add New Category"),1),t("div",_e,[t("div",null,[e[18]||(e[18]=t("label",{for:"name",class:"input-label"},"Category Name",-1)),j(t("input",{id:"name","onUpdate:modelValue":e[2]||(e[2]=o=>l.value.name=o),type:"text",class:"input-primary",required:""},null,512),[[A,l.value.name]])]),t("div",null,[e[19]||(e[19]=t("label",{for:"slug",class:"input-label"},"Slug",-1)),t("div",Me,[j(t("input",{id:"slug","onUpdate:modelValue":e[3]||(e[3]=o=>l.value.slug=o),type:"text",class:"input-primary",disabled:d.value,required:""},null,8,je),[[A,l.value.slug]]),t("button",{type:"button",onClick:R,class:"btn-ghost text-primary-500 px-2"},[(a(),r("svg",De,[d.value?(a(),r("path",Be)):(a(),r("path",$e))]))])]),d.value?(a(),r("span",Le,"Slug will be auto-generated")):i("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{for:"description",class:"input-label"},"Description",-1)),j(t("textarea",{id:"description","onUpdate:modelValue":e[4]||(e[4]=o=>l.value.description=o),rows:"3",class:"input-primary"},null,512),[[A,l.value.description]])]),t("div",null,[e[22]||(e[22]=t("label",{for:"parent",class:"input-label"},"Parent Category (Optional)",-1)),j(t("select",{id:"parent","onUpdate:modelValue":e[5]||(e[5]=o=>l.value.parent=o),class:"select"},[e[21]||(e[21]=t("option",{value:""},"None",-1)),(a(!0),r(U,null,V(S.value,o=>(a(),r("option",{key:o.id,value:o.id,disabled:o.id===l.value.id},v(o.name),9,Te))),128))],512),[[ee,l.value.parent]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"input-label"},"Category Image",-1)),t("div",{class:"border border-dashed border-background-400 rounded-lg p-6 text-center",onDrop:T(G,["prevent"]),onDragover:e[7]||(e[7]=T(()=>{},["prevent"]))},[b.value?(a(),r("div",Ae,[t("img",{src:b.value,alt:"Category image preview",class:"h-40 object-contain rounded"},null,8,ze)])):i("",!0),e[23]||(e[23]=t("p",{class:"text-background-600 dark:text-background-400 mb-4"}," Drag & drop image here or click to browse ",-1)),t("input",{ref_key:"imageInput",ref:E,type:"file",onChange:q,accept:"image/png,image/jpeg,image/webp",class:"hidden"},null,544),t("button",{type:"button",onClick:e[6]||(e[6]=o=>s.$refs.imageInput.click()),class:"btn-secondary"}," Upload Image ")],32)])])]),t("div",Fe,[t("button",{type:"submit",class:"btn-primary sm:ml-3",disabled:x.value},[x.value?(a(),r("span",Ie,e[25]||(e[25]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))):i("",!0),M(" "+v(p.value?"Update Category":"Create Category"),1)],8,He),t("button",{type:"button",onClick:e[8]||(e[8]=o=>k.value=!1),class:"btn-secondary mt-3 sm:mt-0"}," Cancel ")])],32)])])])):i("",!0),w.value?(a(),r("div",Ue,[t("div",Ve,[t("div",{class:"fixed inset-0 bg-background-900 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:e[9]||(e[9]=o=>w.value=!1)}),e[31]||(e[31]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),t("div",Ne,[t("div",Ee,[t("div",Se,[e[28]||(e[28]=t("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-error-100 dark:bg-error-900 sm:mx-0 sm:h-10 sm:w-10"},[t("svg",{class:"h-6 w-6 text-error-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t("div",Pe,[e[27]||(e[27]=t("h3",{class:"heading-4",id:"modal-title"},"Delete Category",-1)),t("div",Re,[D.value?(a(),r("p",qe," Warning: This category has related products. Deleting it may affect those products. ")):i("",!0),t("p",Ge,' Are you sure you want to delete "'+v((c=_.value)==null?void 0:c.name)+'"? This action cannot be undone. ',1)])])])]),t("div",Oe,[t("button",{onClick:J,type:"button",class:"btn-primary bg-error-600 hover:bg-error-700 focus:ring-error-500 sm:ml-3",disabled:C.value},[C.value?(a(),r("span",Je,e[29]||(e[29]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))):i("",!0),e[30]||(e[30]=M(" Delete "))],8,We),t("button",{onClick:e[10]||(e[10]=o=>w.value=!1),type:"button",class:"btn-secondary mt-3 sm:mt-0"}," Cancel ")])])])])):i("",!0),B.value?(a(),r("div",{key:5,class:te(["fixed bottom-6 right-6 max-w-md p-4 rounded-xl shadow-elevated transition-all",{"bg-success-500 text-white":g.value==="success","bg-error-500 text-white":g.value==="error","bg-primary-500 text-white":g.value==="info"}])},[t("div",Ke,[g.value==="success"?(a(),r("svg",Qe,e[32]||(e[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):i("",!0),g.value==="error"?(a(),r("svg",Xe,e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):i("",!0),g.value==="info"?(a(),r("svg",Ye,e[34]||(e[34]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):i("",!0),t("span",null,v(z.value),1)])],2)):i("",!0)])}}};export{tt as default};
