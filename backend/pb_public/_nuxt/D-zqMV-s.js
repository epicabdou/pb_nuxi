import{D as ne,i as le,q as ie,e as ue,r as u,A as de,g as x,j as R,h as ce,c as n,o as s,a as o,y as U,k as w,n as O,C as Z,F as f,l as y,t as j,p as C,z,u as K,x as ge,s as ve,E as pe}from"./DzVV_QxS.js";import{u as me}from"./WUHYirRz.js";import{P as fe}from"./CxIzMdn8.js";import{_ as ke}from"./DSuGT9tI.js";import{u as be,a as he}from"./9jvVpD2D.js";import"./CYKZh6Wd.js";const xe={class:"py-8 md:py-12"},we={class:"responsive-container"},ye={class:"mb-8"},Ce={class:"bg-white dark:bg-background-800 rounded-lg shadow-sm p-4"},_e={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},Pe={class:"relative flex-grow max-w-xs"},Me=["value"],Ae={class:"flex items-center gap-2 self-stretch md:self-auto"},je={class:"relative flex-grow md:flex-grow-0"},Be={class:"flex bg-white dark:bg-background-800 rounded-lg border border-background-300 dark:border-background-700 p-1"},Se={key:0,class:"mt-4 flex flex-wrap items-center gap-2"},Te=["onClick"],Fe={class:"flex justify-between items-center mb-6"},$e={class:"text-sm text-background-700 dark:text-background-300"},qe={class:"text-sm text-background-500"},ze={key:0},Ie={key:0,class:"flex justify-center py-12"},Le={key:1,class:"card-fancy text-center py-16"},De={key:2,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},Ne={key:3,class:"space-y-4"},Ve={key:4,class:"mt-12 flex justify-center"},We={class:"inline-flex rounded-md shadow-sm","aria-label":"Pagination"},Ee=["disabled"],He=["onClick"],Re={key:1,class:"relative inline-flex items-center px-4 py-2 border border-background-300 dark:border-background-700 bg-white dark:bg-background-800 text-sm font-medium text-background-700 dark:text-background-300"},Ue=["disabled"],Oe={__name:"ProductsList",setup(G){const d=ne(),I=le(),_=me(),L=ie(),J=ue(),k=ge(),B=u([]),S=u([]),P=u(!0),D=u(null),c=u(localStorage.getItem("productViewMode")||"grid"),T=u(12),a=u(parseInt(d.query.page)||1),g=u(d.query.sort||"name"),l=u(d.query.category||""),b=u([]);de().public.pocketbaseUrl;const M=x(()=>{if(!B.value.length)return[];let t=[...B.value];return l.value&&(t=t.filter(e=>{var r;return(r=e.expand)!=null&&r.category?Array.isArray(e.expand.category)?e.expand.category.some(p=>p.id===l.value):e.expand.category.id===l.value:!1})),t}),F=x(()=>{if(!M.value.length)return[];const t=[...M.value],e=g.value.replace("-",""),r=g.value.startsWith("-");return t.sort((p,q)=>{let m=p[e],h=q[e];return e==="price"&&(m=p.promoPrice||p.price,h=q.promoPrice||q.price),typeof m=="number"?r?h-m:m-h:typeof m=="string"?r?h.localeCompare(m):m.localeCompare(h):0})}),i=x(()=>Math.ceil(F.value.length/T.value)),N=x(()=>{if(!F.value.length)return[];const t=(a.value-1)*T.value;return F.value.slice(t,t+T.value)}),X=x(()=>{if(i.value<=7)return Array.from({length:i.value},(e,r)=>r+1);const t=[];if(a.value<=3){for(let e=1;e<=5;e++)t.push(e);t.push("..."),t.push(i.value)}else if(a.value>=i.value-2){t.push(1),t.push("...");for(let e=i.value-4;e<=i.value;e++)t.push(e)}else{t.push(1),t.push("...");for(let e=a.value-1;e<=a.value+1;e++)t.push(e);t.push("..."),t.push(i.value)}return t});async function Y(){P.value=!0,D.value=null;try{const{$pb:t}=K(),e=await t.collection("products").getList(1,100,{expand:"category,tags",sort:g.value});B.value=e.items}catch(t){console.error("Error fetching products:",t),D.value="Failed to load products. Please try again later.",k.error("Failed to load products")}finally{P.value=!1}}async function Q(){try{const{$pb:t}=K(),e=await t.collection("categories").getList(1,100);S.value=e.items,A()}catch(t){console.error("Error fetching categories:",t)}}function ee(t){a.value=t,v(),$()}function te(){a.value<i.value&&(a.value++,v(),$())}function oe(){a.value>1&&(a.value--,v(),$())}function re(){a.value=1,A(),v()}function se(){v()}function ae(t){l.value===t&&(l.value=""),A(),v()}function V(){l.value="",b.value=[],v()}function A(){const t=[];if(l.value){const e=S.value.find(r=>r.id===l.value);e&&t.push({id:e.id,name:`Category: ${e.name}`})}b.value=t}function v(){const t={...d.query,page:a.value,sort:g.value};l.value?t.category=l.value:delete t.category,t.page===1&&delete t.page,I.replace({query:t})}function $(){window.scrollTo({top:0,behavior:"smooth"})}function W(t){return L.isInWishlist(t)}async function E(t){if(!J.isAuthenticated){ve(`/login?redirect=${encodeURIComponent(d.fullPath)}`);return}try{const e=await L.toggleWishlist(t.id);e.added?k.success(`${t.name} added to wishlist`):e.removed&&k.info(`${t.name} removed from wishlist`)}catch(e){console.error("Error toggling wishlist:",e),k.error("Failed to update wishlist")}}function H(t){const e=t.quantity||1;_.addItem({id:t.id,name:t.name,price:t.promoPrice||t.price,image:t.image,quantity:e}),k.success(`${t.name} added to cart`),_.toggleCart()}return R(c,t=>{localStorage.setItem("productViewMode",t)}),R(()=>d.query,t=>{t.page?a.value=parseInt(t.page):a.value=1,t.sort&&(g.value=t.sort),t.category!==void 0&&(l.value=t.category,A())},{deep:!0}),ce(async()=>{await Promise.all([Q(),Y()])}),be({title:"Products - Discover Our Collection",meta:[{name:"description",content:"Browse our collection of high-quality products designed for your needs."}]}),(t,e)=>(s(),n("main",xe,[o("div",we,[e[19]||(e[19]=U('<section class="mb-8"><div class="rounded-xl overflow-hidden relative"><div class="h-64 md:h-80 lg:h-96 w-full bg-gradient-to-r from-primary-500 to-secondary-500 flex items-center justify-center"><div class="text-center text-white px-4 relative z-10"><h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4">Discover Our Products</h1><p class="text-lg md:text-xl max-w-2xl mx-auto">Browse our collection of high-quality products designed for your needs.</p></div></div></div></section>',1)),o("section",ye,[o("div",Ce,[o("div",_e,[o("div",Pe,[e[5]||(e[5]=o("label",{for:"category-filter",class:"sr-only"},"Filter by Category",-1)),O(o("select",{id:"category-filter","onUpdate:modelValue":e[0]||(e[0]=r=>l.value=r),class:"input-primary py-2 pr-8 text-sm rounded-lg w-full appearance-none cursor-pointer",onChange:re},[e[4]||(e[4]=o("option",{value:""},"All Categories",-1)),(s(!0),n(f,null,y(S.value,r=>(s(),n("option",{key:r.id,value:r.id},j(r.name),9,Me))),128))],544),[[Z,l.value]]),e[6]||(e[6]=o("div",{class:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-background-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),o("div",Ae,[o("div",je,[O(o("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>g.value=r),class:"input-primary py-2 pl-3 pr-8 text-sm rounded-lg appearance-none cursor-pointer",onChange:se},e[7]||(e[7]=[U('<option value="name">Name (A-Z)</option><option value="-name">Name (Z-A)</option><option value="price">Price (Low to High)</option><option value="-price">Price (High to Low)</option><option value="-created">Newest</option>',5)]),544),[[Z,g.value]]),e[8]||(e[8]=o("div",{class:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-background-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),o("div",Be,[o("button",{onClick:e[2]||(e[2]=r=>c.value="grid"),class:C(["p-1.5 rounded",c.value==="grid"?"bg-primary-100 text-primary-600 dark:bg-primary-900":"text-background-600"])},e[9]||(e[9]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]),2),o("button",{onClick:e[3]||(e[3]=r=>c.value="list"),class:C(["p-1.5 rounded",c.value==="list"?"bg-primary-100 text-primary-600 dark:bg-primary-900":"text-background-600"])},e[10]||(e[10]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)]),2)])])]),b.value.length>0?(s(),n("div",Se,[e[12]||(e[12]=o("span",{class:"text-sm text-background-700 dark:text-background-300"},"Active Filters:",-1)),(s(!0),n(f,null,y(b.value,r=>(s(),n("div",{key:r.id,class:"inline-flex items-center bg-background-100 dark:bg-background-800 text-xs rounded-full px-3 py-1"},[o("span",null,j(r.name),1),o("button",{onClick:p=>ae(r.id),class:"ml-2 text-background-500 hover:text-error-500"},e[11]||(e[11]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Te)]))),128)),b.value.length>0?(s(),n("button",{key:0,onClick:V,class:"text-xs text-primary-600 hover:underline"}," Clear All ")):w("",!0)])):w("",!0)])]),o("div",Fe,[o("p",$e,j(M.value.length)+" products found ",1),o("div",qe,[P.value?(s(),n("span",ze,"Loading products...")):w("",!0)])]),P.value?(s(),n("div",Ie,e[13]||(e[13]=[o("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):M.value.length===0?(s(),n("div",Le,[e[14]||(e[14]=o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 mx-auto text-background-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e[15]||(e[15]=o("h3",{class:"text-xl font-bold mb-2"},"No Products Found",-1)),e[16]||(e[16]=o("p",{class:"text-background-600 dark:text-background-400 mb-6"}," We couldn't find any products that match your criteria. Please try different filters or check back later. ",-1)),o("button",{onClick:V,class:"btn-primary"}," Clear Filters ")])):c.value==="grid"?(s(),n("div",De,[(s(!0),n(f,null,y(N.value,r=>(s(),z(fe,{key:r.id,product:r,"is-in-wishlist":W(r.id),onAddToCart:H,onAddToWishlist:E},null,8,["product","is-in-wishlist"]))),128))])):c.value==="list"?(s(),n("div",Ne,[(s(!0),n(f,null,y(N.value,r=>(s(),z(ke,{key:r.id,product:r,"is-in-wishlist":W(r.id),onAddToCart:H,onAddToWishlist:E},null,8,["product","is-in-wishlist"]))),128))])):w("",!0),i.value>1?(s(),n("div",Ve,[o("nav",We,[o("button",{onClick:oe,disabled:a.value===1,class:C(["relative inline-flex items-center px-2 py-2 rounded-l-md border border-background-300 dark:border-background-700 bg-white dark:bg-background-800 text-sm font-medium",a.value===1?"text-background-400 cursor-not-allowed":"text-background-700 dark:text-background-300 hover:bg-background-100 dark:hover:bg-background-700"])},e[17]||(e[17]=[o("span",{class:"sr-only"},"Previous",-1),o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),10,Ee),(s(!0),n(f,null,y(X.value,r=>(s(),n(f,{key:r},[r!=="..."?(s(),n("button",{key:0,onClick:p=>ee(r),class:C(["relative inline-flex items-center px-4 py-2 border border-background-300 dark:border-background-700 text-sm font-medium",a.value===r?"z-10 bg-primary-500 border-primary-500 text-white":"bg-white dark:bg-background-800 text-background-700 dark:text-background-300 hover:bg-background-100 dark:hover:bg-background-700"])},j(r),11,He)):(s(),n("span",Re," ... "))],64))),128)),o("button",{onClick:te,disabled:a.value===i.value,class:C(["relative inline-flex items-center px-2 py-2 rounded-r-md border border-background-300 dark:border-background-700 bg-white dark:bg-background-800 text-sm font-medium",a.value===i.value?"text-background-400 cursor-not-allowed":"text-background-700 dark:text-background-300 hover:bg-background-100 dark:hover:bg-background-700"])},e[18]||(e[18]=[o("span",{class:"sr-only"},"Next",-1),o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),10,Ue)])])):w("",!0)])]))}},et=pe({__name:"index",setup(G){return he({title:"Ajimall | Store",ogTitle:"Ajimall | Store",description:"This is my amazing site, let me tell you all about it.",ogDescription:"This is my amazing site, let me tell you all about it.",ogImage:"https://example.com/image.png",twitterCard:"summary_large_image"}),(d,I)=>{const _=Oe;return s(),z(_)}}});export{et as default};
