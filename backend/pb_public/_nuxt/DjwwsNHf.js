import{_ as k}from"./CYKZh6Wd.js";import{u as C,e as S,q as W,r as m,f as A,h as E,s as T,x as F,c as a,a as n,y as N,b as P,w as V,t as B,F as L,l as $,o,d as q,z as M}from"./DzVV_QxS.js";import{u as j}from"./WUHYirRz.js";import{P as I}from"./CxIzMdn8.js";import{u as z}from"./9jvVpD2D.js";const D={class:"responsive-container section-padding"},H={key:0,class:"flex justify-center items-center py-16"},Y={key:1,class:"card text-center py-12"},G={key:2},J={class:"mb-8 flex justify-between items-center"},K={class:"text-sm text-background-700 dark:text-background-300"},O=["disabled"],Q={key:0},R={key:1},U={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},ot={__name:"wishlist",setup(X){const{$pb:l}=C(),h=S(),f=j(),p=W(),i=F(),g=m(!0),r=m([]),y=A({}),v=m(null),d=m(!1);z({title:"My Wishlist",meta:[{name:"description",content:"View and manage your saved items"}]}),E(async()=>{if(!h.isAuthenticated)return T("/login?redirect=/wishlist");try{await w()}catch(t){console.error("Error fetching wishlist:",t),i.error("Failed to load wishlist items")}finally{g.value=!1}});async function w(){if(!(!h.isAuthenticated||!l.authStore.isValid))try{const t=l.authStore.model.id,e=await l.collection("wishlists").getList(1,100,{filter:`user="${t}"`,expand:"product"});r.value=e.items.map(s=>({id:s.id,product:s.expand.product}))}catch(t){throw console.error("Error fetching wishlist items:",t),t}}async function x(t){var e;y[t]=!0;try{const s=r.value.find(u=>u.id===t),c=((e=s==null?void 0:s.product)==null?void 0:e.name)||"Item";await l.collection("wishlists").delete(t),r.value=r.value.filter(u=>u.id!==t),i.success(`${c} removed from wishlist`),p.fetchItems()}catch(s){console.error("Error removing from wishlist:",s),i.error("Failed to remove item")}finally{y[t]=!1}}async function _(){if(confirm("Are you sure you want to clear your entire wishlist?")){d.value=!0;try{const t=r.value.map(e=>l.collection("wishlists").delete(e.id));await Promise.all(t),r.value=[],i.success("Wishlist cleared"),p.fetchItems()}catch(t){console.error("Error clearing wishlist:",t),i.error("Failed to clear wishlist")}finally{d.value=!1}}}async function b(t){if(!t||t.stock<=0)return;const e=t.quantity||1;v.value=t.id;try{f.addItem({id:t.id,name:t.name,price:t.promoPrice||t.price,image:t.image,quantity:e}),i.success(`${t.name} added to cart`),f.toggleCart()}catch(s){console.error("Error adding to cart:",s),i.error("Failed to add item to cart")}finally{v.value=null}}return(t,e)=>{const s=k;return o(),a("main",D,[e[3]||(e[3]=n("h1",{class:"heading-2 mb-8"},"My Wishlist",-1)),g.value?(o(),a("div",H,e[0]||(e[0]=[n("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):r.value.length===0?(o(),a("div",Y,[e[2]||(e[2]=N('<div class="text-background-400 mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg></div><h3 class="text-xl font-medium mb-2">Your Wishlist is Empty</h3><p class="text-background-600 dark:text-background-400 mb-8"> Save items you&#39;re interested in for later by adding them to your wishlist. </p>',3)),P(s,{to:"/products",class:"btn-primary inline-flex"},{default:V(()=>e[1]||(e[1]=[q(" Explore Products ")])),_:1})])):(o(),a("div",G,[n("div",J,[n("p",K,B(r.value.length)+" items in your wishlist ",1),n("button",{onClick:_,class:"btn-ghost text-sm text-error-600 hover:text-error-700",disabled:d.value},[d.value?(o(),a("span",Q,"Clearing...")):(o(),a("span",R,"Clear Wishlist"))],8,O)]),n("div",U,[(o(!0),a(L,null,$(r.value,c=>(o(),M(I,{key:c.id,product:c.product,"is-in-wishlist":!0,onAddToCart:b,onAddToWishlist:u=>x(c.id)},null,8,["product","onAddToWishlist"]))),128))])]))])}}};export{ot as default};
